{% extends "base.html" %}

{% block title %}Search{% endblock %}

{% block extra_header %}
{% endblock %}

{% block content %}
<div id="search">
    <form id="search-form">
        <input id="search-query" type="text" name="query" value="" />
        <input type="submit" id="search-submit" value="Search" />
    </form>
</div>
<div id="results">
</div>

<script type="text/template" id="results-template"> 
    <%= meta.offset %> through <%= meta.limit %> of <%= meta.total_count %><br />
    <% _.each(objects, function(obj) { %>
        <% _.each(obj.csv_data, function(d) { %>
            <%= d %>
        <% }); %><br />
    <% }); %>
</script>
{% endblock %}

{% block extra_footer %}
<script type="text/javascript" src="{{ MEDIA_URL }}js/underscore-min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/backbone-min.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/backbone-tastypie.js"></script>
<script type="text/javascript" src="{{ MEDIA_URL }}js/redd.js"></script>
<script type="text/javascript">
$(function() {
    var results_template = _.template($('#results-template').html());

    $("#search-form").submit(function() {
        Data.search($("#search-form #search-query").val(), 10, 0);

        return false;
    }); 
})
</script>
{% endblock %}
